<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<head>
  <title>Variables for descriptors.</title>
  <link rel="stylesheet" href="ProActive.css">
</head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<body style="background-color: white;">
<table width="100%">
  <tbody>
    <tr>
      <td align="left" valign="middle">
      <table border="1" cellpadding="2" cellspacing="0">
        <tbody>
          <tr>
            <td class="smallLink1">&nbsp;&nbsp;<a class="smallLink1" href="../../../../overview-summary.html">back to API</a>&nbsp;&nbsp;</td>
            <td class="smallLink1">&nbsp;&nbsp;<a class="smallLink1" href="index.html">back to index</a>&nbsp;&nbsp;</td>
            <td class="smallLink2">&nbsp;&nbsp;<a class="smallLink2" href="Descriptor.html">prev</a>&nbsp;&nbsp;</td> 
 	    <td class="smallLink2">&nbsp;&nbsp;<a class="smallLink2" href="FileTransfer.html">next</a>&nbsp;&nbsp;</td>
          </tr>
        </tbody>
      </table>
      </td>
      <td align="right" valign="top">
      <img src="ProActiveLogo200x34.gif"></td>
    </tr>
  </tbody>
</table>
<HR>
<H1>Variables for Descriptors</H1>
<H2>Principle</H2>
<P>The objective of this feature is to allow the use of variables inside
XML descriptors. Variables can be defined: directly in the descriptor, using
independent files, or inside the deploying application's code (with an API).</P>

<P>The variable tags are usefull inside a descriptor because they can factorize frequent parameters. For example, a variable like ${PROACTIVE_HOME} can be defined, set and used in an XML Descriptor.</P>

<h2><a name="variableTypes">Variable Types</a></h2>

	   <ul><table>
	  		<tr>
				<th><p>Type</p></th>
				<th><p>Variable Declaration</p></th>
				<th><p>Value Setting</p></th>
				<th><p>Priority</p></th>
			</tr>
			<tr>
				<td><p><b>constant</b></p></td>
				<td><p>Descriptor</p></td>
				<td><p>Descriptor </p></td>
				<td><p>Descriptor</p></td>
			</tr>
			<tr>
				<td><p><b>overridableInProgram</b></p></td>
				<td><p>Descriptor</p></td>
				<td><p>Descriptor or Program</p></td>
				<td><p>Program</p></td>
			</tr>
			<tr>
				<td><p><b>overridableInXML</b></p></td>
				<td><p>Descriptor</p></td>
				<td><p>Descriptor or Program</p></td>
				<td><p>Descriptor</p></td>
			</tr>
			<tr>
				<td><p><b>setInProgram</b></p></td>
				<td><p>Descriptor</p></td>
				<td><p>Program</p></td>
				<td><p>Program</p></td>
			</tr>
						<tr>
				<td><p><b>javaProperty</b></p></td>
				<td><p>Descriptor</p></td>
				<td><p>JavaProperty</p></td>
				<td><p>JavaProperty</p></td>
			</tr>

	   </table></ul>

<p> Variables can be defined in more than one place. When the value is set on multiple places, then the definition specified in the priority column will take precedence.</p>
	
<H2>Variables Example</H2>
<H3>Descriptor Variables</H3>
<p>All variable declarations must be written in a variable section at the beginning of the descriptor file in the following way:</p>

<pre CLASS="xml">
	&lt;variables&gt;
	&nbsp;&lt;property name=&quot;<b>USER_HOME</b>" value=&quot;<b>/usr/home/team</b>"/&gt; <FONT ID="FormalComment">&lt;!-- constant is default--&gt;</FONT>
	&nbsp;&lt;property name="<b>PROACTIVE_HOME</b>" value="<b>ProActive/dist/ProActive</b>" type="<b>constant</b>"/&gt;

	&nbsp;&lt;property name="<b>OPTIONAL_NODES</b>" value="<b>2</b>" type="<b>overrridableInXML</b>"/&gt;
	&nbsp;&lt;property name="<b>USE_P2P</b>" value="<b>yes</b>" type="<b>overrridableInProgram</b>"/&gt;
	&nbsp;&lt;property name="<b>NEEDED_NODES</b>" value="" type="<b>setInProgram</b>" /&gt;
		  
	&nbsp;<FONT ID="FormalComment">&lt;!-- example using jvm properties --&gt;</FONT>
	&nbsp;&lt;property name="<b>JAVA_HOME</b>" value="<b>java.home</b>" type="<b>javaProperty</b>"/&gt;

	&nbsp;<FONT ID="FormalComment">&lt;!-- loading external files with variables definitions --&gt;</FONT>
	&nbsp;&lt;propertiesFile location="<b>context.properties</b>"/&gt;
	&nbsp;&lt;property file="<b>context.xml</b>"/&gt;
	&lt;/variables&gt;

	<FONT ID="FormalComment">&lt;!-- example usage --&gt;</FONT>
	...
	&lt;classpath&gt;
	&nbsp;&lt;absolutePath value="<b>${USER_HOME}/${PROACTIVE_HOME}/ProActive.jar</b>"/&gt;
	&nbsp;&lt;absolutePath value="<b>${JAVA_HOME}/lib/asm.jar</b>"/&gt;
	&lt;/classpath&gt;
	...
</pre>

<h3>Program Variables</h3>
<UL>
	<PRE CLASS="snippet" STYLE="margin-bottom: 0.5cm; line-height: 150%">
XMLProperties.setVariableValue( "<b>OPTIONAL_NODES</b>", "<b>4</b>", "<b>overridableInXML</b>");
XMLProperties.setVariableValue( "<b>USE_P2P</b>", "<b>no</b>", "<b>overridableInProgram</b>");
XMLProperties.setVariableValue( "<b>NEEDED_NODES</b>", "<b>50</b>", "<b>setInProgram</b>");
</PRE></UL>
<br>

<H2>External Variable Definitions Files</H2>

<h3>XML Files</h3>
<P>Is built using XML property tags.</P>
    <P STYLE="border: none; padding: 0cm; line-height: 150%"><FONT FACE="Verdana, Helvetica, Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt"><B>File 
      : context.xml</B></FONT></FONT></P>
    <TABLE WIDTH=100% CELLPADDING=2 CELLSPACING=0>
      <COL WIDTH=256*>
      <TR> 
        <TD WIDTH=100%> <TABLE CLASS="xml" DIR="LTR" ALIGN=LEFT WIDTH=663 CELLPADDING=2 CELLSPACING=0>
            <COL WIDTH=659>
            <TR> 
              <TD  WIDTH=659 align="left"> 
	      <PRE CLASS="xml">

	<FONT ID="FormalComment">&lt;!-- Definition of the specific context --&gt;</FONT>
	&lt;property name="<b>USER_HOME</b>" value="<b>/usr/home/team</b>" /&gt;
	&lt;property name="<b>PROACTIVE_HOME</b>" value="<b>ProActive/dist/ProActive</b>" /&gt;
	&lt;property name="<b>MIN_NODES</b>" value="<b>45</b>" /&gt;
	</PRE>
	  	</TD>
            </TR>
          </TABLE></TD>
      </TR>
    </TABLE>


<h3>Properties Files</h3>

<P>This approach uses <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/Properties.html#load(java.io.InputStream)">Sun microsystems properties file format</a>. The format is plain text with one definition per line in the format <b>variable = value</b>, as shown in the following example:</P>
    
    <P STYLE="border: none; padding: 0cm; line-height: 150%"><FONT FACE="Verdana, Helvetica, Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt"><B>File 
      : context.properties</B></FONT></FONT></P>
    <TABLE WIDTH=100% CELLPADDING=2 CELLSPACING=0>
      <COL WIDTH=256*>
      <TR> 
        <TD WIDTH=100%> <TABLE CLASS="xml" DIR="LTR" ALIGN=LEFT WIDTH=663 CELLPADDING=2 CELLSPACING=0>
            <COL WIDTH=659>
            <TR> 
              <TD  WIDTH=659 align="left">
	      <PRE CLASS="xml">

	<FONT ID="FormalComment"># Definition of the specific context</FONT>
	USER_HOME = /usr/home/team
	PROACTIVE_HOME = ProActive/dist/ProActive
	MIN_NODES : 45
	</PRE></TD>
            </TR>
          </TABLE></TD>
      </TR>
    </TABLE>
<p> Note that colon (:) can be used instead of equal (=).
    
<H2>Program Variable API</H2>

<P>The API for adding a single variable value is show below. The <b>name</b> corresponds to the variable name, and the <b>value</b> to the variable content. The <b>type</b> is the String corresponding to one of the <a href="#variableTypes">supported variable types</a>.</P>
<code class="snippet">static public XMLProperties.setVariableValue( String <b>name</b>, String <b>value</b>, String <b>type</b>);<br></code>
<P>The API for adding a multiple variables is shown below. The variable <b>name</b>/<b>value</b> pair is specified as the key/content of the HashMap. The <b>type</b> is the String corresponding to one of the <a href="#variableTypes">supported variable types</a>.</P>
<code class="snippet">static public XMLProperties.setVariableValue( HashMap <b>map</b>, String <b>type</b>);<br></code>

<br>
<HR>
<P ALIGN=RIGHT STYLE="margin-bottom: 0cm"><FONT FACE="Verdana, Helvetica, Arial, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Copyright
&copy; April 2005 INRIA All Rights Reserved.</FONT></FONT>
</P>
</BODY>
</HTML>
