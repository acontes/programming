<html>
<head>
<title>Hello world ! (tiny example)</title>
<link rel="stylesheet" href="ProActive.css">
</head>
<body bgcolor="white">

<!--
 Header : start 
~~~ -->
<table width="100%">
	<tr>
		<td align="left" valign="middle">
		<table cellpadding="2" cellspacing="0" border="1">
			<tr>
				<td class="smallLink1">&nbsp;&nbsp;<a class="smallLink1"
					href="../../../../overview-summary.html">back to API</a>&nbsp;&nbsp;</td>
				<td class="smallLink1">&nbsp;&nbsp;<a class="smallLink1" href="index.html">back to index</a>&nbsp;&nbsp;</td>
				<td class="smallLink2">&nbsp;&nbsp;<a class="smallLink2" href="Principles.html">prev</a>&nbsp;&nbsp;</td>
				<td class="smallLink2">&nbsp;&nbsp;<a class="smallLink2" href="Installation.html">next</a>&nbsp;&nbsp;</td>
			</tr>
		</table>
		</td>
		<td align="right" valign="top"><img src="ProActiveLogo200x34.gif" /></td>
	</tr>
</table>
<hr>
<!-- Link to index : end -->

<h1>Hello world ! (tiny example)</h1>
<p class="textNormal">This example implements the smallest program in ProActive. This is the easiest
program you could write, using the Active Object concept. This is just to show quickly how code can 
be written, with minimal knowledge of the API. </p>

<p>You can get a more complete "hello world" example, with deployment on a remote host, <a
	href="HelloWorld.html">further on</a> in the manual.</p>

<p>A client object displays a <code>String</code> received from elsewhere (the original VM). This
illustrates the creation of an Active Object.</p>
<p class="textNormal">Only one classe is needed : we have put the main method inside the class,
which when deployed will be an Active Object.</p>
<h2>The TinyHello class</h2>
<p class="textNormal">This class can be used as an Active Object, serving requests. Its creation
involves the following steps:</p>
<ul>
	<li>Provide an implementation for the required server-side functionalities</li>
	<li>Provide an empty, no-arg constructor</li>
	<li>Write a <code>main</code> method in order to instantiate one server object.</li>
</ul>
<p class="textNormal">Here is a possible implementation for the <code>TinyHello</code> class:</p>
<table align="center" width="96%" border="1" cellpadding="5" cellspacing="0">
	<tbody>
		<tr>
			<th align="center" bgcolor="#ccccff">TinyHello.java</th>
		</tr>
		<tr>
			<td><pre>
package org.objectweb.proactive.examples.hello;

import org.apache.log4j.Logger;
import org.objectweb.proactive.ProActive;
import org.objectweb.proactive.core.util.log.*;
import org.objectweb.proactive.core.util.wrapper.StringMutableWrapper;
import java.net.UnknownHostException;

/** 
 * A stripped-down Active Object example.
 * The object has only one public method, sayHello()
 * The object does nothing but reflect the host its on. 
 */

public class TinyHello implements java.io.Serializable {
    static Logger logger = ProActiveLogger.getLogger(Loggers.EXAMPLES);
    private final String message = "Hello World!";

    /** ProActive compulsory no-args constructor */
    public TinyHello() {
    }

    /** The Active Object creates and returns information on its location
     * @return a StringWrapper which is a Serialized version, for asynchrony */
    public StringMutableWrapper <span style="color: rgb(0, 121, 0);">sayHello()</span> {
        return new StringMutableWrapper(
            this.message + "\n from " + getHostName() + "\n at " +
            new java.text.SimpleDateFormat("dd/MM/yyyy HH:mm:ss").format(new java.util.Date()));
    }

    /** finds the name of the local machine */
    static String getHostName() {
        try {
            return java.net.InetAddress.getLocalHost().toString();
        } catch (UnknownHostException e) {
            return "unknown";
        }
    }

    /** The call that starts the Acive Objects, and displays results.
     * @param args must contain the name of an xml descriptor */
    public static void main(String[] args)
        throws Exception {
        // Creates an active instance of class Tiny on the local node
<span style="color: rgb(0, 121, 0);">        TinyHello tiny = (TinyHello) ProActive.newActive(
                TinyHello.class.getName(), </span>// the class to deploy
<span style="color: rgb(0, 121, 0);">                null </span>// the arguments to pass to the constructor, here none
<span style="color: rgb(0, 121, 0);">            );  </span>
        // get and display a value 
        StringMutableWrapper received = <span style="color: rgb(0, 121, 0);">tiny.sayHello();</span> // possibly remote call
        logger.info("On " + getHostName() + ", a message was received: " + received); // potential wait-by-necessity 
    }
}
</pre></td>
		</tr>
	</tbody>
</table>
<br></br>


<h2>Implement the required functionalities</h2>

<p class="textNormal">Implementing any remotely-accessible functionality is simply done through
normal Java methods in a normal Java class, in exactly the same manner it would have been done in a
non-distributed version of the same class. Here, the only method is <code>sayHello</code>
<h2>Creating the <code>Hello</code> Active Object</h2>

<p class="textNormal">Now that we know how to write the class that implements the required
server-side functionalities, let us see how to create the server object. We want this active object
to be created on the current node, which is why we use <code>newActive</code> with only two
parameters (done in the <code>main</code> method).</p>
<p>The code snippet which instantiates the <code>TinyHello</code> in the same VM is the following
(in the <code>main</code> method):</p>

<pre>
        TinyHello tiny = (TinyHello) ProActive.newActive(
                TinyHello.class.getName(), // the class to deploy
                null // the arguments to pass to the constructor, here none
            ); // which jvm should be used to hold the Active Object
</pre>

<h2>Invoking a method on a remote object and printing out the message</h2>

<p class="textNormal">This is exactly like invoking a method on a local object of the same type. The
user does not have to deal with catching distribution-related exceptions.</p>


<p class="textNormal">As already stated, the only modification brought to the code by ProActive is
located at the place where active objects are created. All the rest of the code remains the same,
which fosters software reuse. So the way to call the <code>sayHello</code> method in this example is
the following (in the <code>main</code> method):</p>

<pre>
        StringMutableWrapper received = tiny.sayHello(); // possibly remote call
        logger.info("On " + getHostName() + ", a message was received: " + received); // potential wait-by-necessity 
</pre>



<h2>Launching</h2>
<p class="textNormal">To launch the example, you may type :</p>
<code> linux> java -Djava.security.policy=scripts/proactive.java.policy
-Dlog4j.configuration=file:scripts/proactive-log4j org.objectweb.proactive.examples.hello.TinyHello<br>
<br>
windows> java -Djava.security.policy=scripts\proactive.java.policy
-Dlog4j.configuration=file:scripts\proactive-log4j org.objectweb.proactive.examples.hello.TinyHello
</code>

<br>
<p class="textNormal">There are also scripts in the <code>scripts</code> directory :</p>
<code> linux> cd scripts/unix/ <br>
linux> tinyHello.sh <br>
<br>
windows> cd scripts/windows<br>
windows> tinyHello.bat </code>

<h3>The output</h3>
<pre>
[apple unix]tinyhello.sh

--- Hello World tiny example ---------------------------------------------
 --> This ClassFileServer is reading resources from classpath
ProActive Security Policy (proactive.runtime.security) not set. Runtime Security disabled
Created a new registry on port 1099
//apple.inria.fr/Node628280013 successfully bound in registry at //apple.inria.fr/Node628280013
Generating class : pa.stub.org.objectweb.proactive.examples.hello.Stub_TinyHello
Generating class : pa.stub.org.objectweb.proactive.core.util.wrapper.Stub_StringMutableWrapper
On apple/138.96.218.62, a message was received: Hello World!
 from apple/138.96.218.62
 at 03/11/2005 14:25:32
</pre>


<!--
 Footer : start 
~~~ -->
<br>
<hr>
<div align="right" class="textSmall">Copyright &#169; 2001-2005 INRIA All Rights Reserved. <!-- Footer : end -->
</body>
</html>
