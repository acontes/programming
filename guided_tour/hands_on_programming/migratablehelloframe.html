<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>ProActive guided tour</title>
  <link rel="stylesheet" href="../../ProActive.css">
</head>
<body style="background-color: rgb(255, 255, 255);">
<!--
 Header : start 
~~~ -->
<table width="100%">
  <tbody> 
  <tr> 
    <td align="left" valign="middle"> 
      <table cellpadding="2" cellspacing="0" border="1">
        <tbody> 
        <tr> 
          <td class="smallLink1">&nbsp;&nbsp;<a class="smallLink1" href="../../../../../../overview-summary.html">back to API</a>&nbsp;&nbsp;</td>
    <td class="smallLink1">&nbsp;&nbsp;<a class="smallLink1" href="../../index.html">back to index</a>&nbsp;&nbsp;</td>
          <td class="smallLink1">&nbsp;&nbsp;<a class="smallLink1" href="../index.html">back 
to guided tour index</a>&nbsp;&nbsp;</td>
          <td class="smallLink2">&nbsp;&nbsp;<a class="smallLink2"
 href="migratablehello.html">prev</a>&nbsp;&nbsp;</td>
          <td class="smallLink2">&nbsp;&nbsp;<a class="smallLink2"
 href="../synchronization.html">next</a>&nbsp;&nbsp;</td>
        </tr>
        </tbody> 
      </table>
    </td>
    <td align="right" valign="top"> <a
 href="http://www-sop.inria.fr/oasis/ProActive/"><img
 src="../../ProActiveLogo200x34.gif" width="200" height="34"
 border="0"></a> </td>
  </tr>
  </tbody> 
</table>
<hr><!-- Link to index : end -->
<h1>1.4. migration of graphical interfaces</h1>
<p>Graphical interfaces are not serializable, yet it is possible to migrate them 
  with ProActive.<br>
  The idea is to associate the graphical object to an active object. The active 
  object will control the activation and desactivation of this graphical entity 
  during migrations. </p>
<p>Of course, this is a very basic example, but you can later build more sophisticated 
  frames. </p>
<h2>Design of the application</h2>
<p>We will write a new active object class, that extends MigratableHello. The 
  sayHello method will create a window containing the hello message. This window 
  is defined in the class HelloFrame</p>
<img src="../pics/hello/hellogui.gif"> 
<h2>Programming</h2>
<h3>HelloFrameController</h3>
<p>The code of the HelloFrameController is <a href="code/HelloFrameController.java.html">here</a>.
</p>
<p>This class extends MigratableHello, and adds an activity and a migration strategy 
  manager to the object .<br>
  It creates a graphical frame upon call of the sayHello method.</p>
<p>Here we have a more complex migration process than with the previous example. 
  We need to make the graphical window disappear before and reappear in a new 
  location after the migration (in this example though, we wait for a call to 
  sayHello). The migration of the frame is actually controlled by a MigrationStrategyManager, 
  that will be attached to the body of the active object.. An ideal location for 
  this operation is the initActivity method (from InitActive interface), that 
  we override :</p>
  <pre class="snippet">/**
 * This method attaches a migration strategy manager to the current active object.
 * The migration strategy manager will help to define which actions to take before
 * and after migrating
 */
public void initActivity(Body body) {
	// add a migration strategy manager on the current active object
	migrationStrategyManager = new MigrationStrategyManagerImpl((Migratable) ProActive.getBodyOnThis());
	// specify what to do when the active object is about to migrate
	// the specified method is then invoked by reflection
	migrationStrategyManager.onDeparture("clean");
}
</pre>
<p>The MigrationStrategyManager defines methods such as "onDeparture", that can 
  be configured in the application. For example here, the method "clean" will 
  be called before the migration, conveniently killing the frame :</p>
  <pre class="snippet">public void clean() {
	System.out.println("killing frame");
	helloFrame.dispose();
	helloFrame = null;
	System.out.println("frame is killed");
}
</pre>
<h3>HelloFrame</h3>
<p>This is an example of a graphical class that could be associated with the active 
  object. <a href="code/HelloFrame.java.html">Here</a> is the code.</p>
<h2>Execution</h2>
<p>
<li>Similarly to the simple migration example (use the <a href="code/HelloFrameController.java.html">HelloFrameController</a> class), you will start remote nodes and 
  specify a migration path.</li>
<li>don't forget to set the security permissions</li>
<li>you have 2 ways for handling the display of the graphical objects :</li>
<ul>
  <ul>
    <li> look on the display screens of the machines<br>
    </li>
  </ul>
</ul>
<ul>
  <ul>
    <li>export the displays : in startNode.sh, you should add the following lines 
      before the java command : 
      <blockquote> 
        <blockquote>
          <p><code>DISPLAY=myhost:0<br>
            export DISPLAY </code> </p>
          <p>&nbsp;</p>
        </blockquote>
      </blockquote>
    </li>
  </ul>
</ul>
<br>
<img src="../pics/hello/hellogui-snapshot.png" width=374 height=62 border=0><br>
<span class="legend">The displayed window : it just contains a text label with 
the location of the active object.</span> 
</body>
</html>
