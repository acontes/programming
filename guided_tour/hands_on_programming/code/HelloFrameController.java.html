<html>
<head>
  <title>HelloFrameController.java</title>
</head>
<body bgcolor="#ffffff" text="#000000">
<pre>
<font color="0000ff"><strong>package org.objectweb.proactive.examples.hello;</strong></font>
<br>
<pre>
<font color="0000ff"><strong>import org.objectweb.proactive.ActiveObjectCreationException;</strong></font>
<font color="0000ff"><strong>import org.objectweb.proactive.Body;</strong></font>
<font color="0000ff"><strong>import org.objectweb.proactive.ProActive;</strong></font>
<font color="0000ff"><strong>import org.objectweb.proactive.core.body.migration.Migratable;</strong></font>
<font color="0000ff"><strong>import org.objectweb.proactive.core.node.NodeException;</strong></font>
<font color="0000ff"><strong>import org.objectweb.proactive.ext.migration.MigrationStrategyManager;</strong></font>
<font color="0000ff"><strong>import org.objectweb.proactive.ext.migration.MigrationStrategyManagerImpl;</strong></font>

<font color="#444444"><i>/**
 *
 * This class allows the &quot;migration&quot; of a graphical interface. A gui object is attached
 * to the current class, and the gui is removed before migration, thanks to the use
 * of a MigrationStrategyManager
 */</i></font>
<strong>public</strong> <strong>class</strong> <font color="#2040a0">HelloFrameController</font> <strong>extends</strong> <font color="#2040a0">MigratableHello</font> <font color="4444FF"><strong>{</strong></font>
	<font color="#2040a0">HelloFrame</font> <font color="#2040a0">helloFrame</font><font color="4444FF">;</font>
	<font color="#2040a0">MigrationStrategyManager</font> <font color="#2040a0">migrationStrategyManager</font><font color="4444FF">;</font>

	<font color="#444444"><i>/**required empty constructor */</i></font>
	<strong>public</strong> <font color="#2040a0">HelloFrameController</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font> <font color="4444FF"><strong>{</strong></font>
	<font color="4444FF"><strong>}</strong></font>

	<font color="#444444"><i>/**constructor */</i></font>
	<strong>public</strong> <font color="#2040a0">HelloFrameController</font><font color="4444FF"><strong>(</strong></font><font color="#2040a0">String</font> <font color="#2040a0">name</font><font color="4444FF"><strong>)</strong></font> <font color="4444FF"><strong>{</strong></font>
		<strong>super</strong><font color="4444FF"><strong>(</strong></font><font color="#2040a0">name</font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
	<font color="4444FF"><strong>}</strong></font>

	<font color="#444444"><i>/**
	 * This method attaches a migration strategy manager to the current active object.
	 * The migration strategy manager will help to define which actions to take before
	 * and after migrating
	 */</i></font>
	<strong>public</strong> <strong>void</strong> <font color="#2040a0">initActivity</font><font color="4444FF"><strong>(</strong></font><font color="#2040a0">Body</font> <font color="#2040a0">body</font><font color="4444FF"><strong>)</strong></font> <font color="4444FF"><strong>{</strong></font>
		<font color="#444444">// add a migration strategy manager on the current active object</font>
		<font color="#2040a0">migrationStrategyManager</font> <font color="4444FF">=</font> <strong>new</strong> <font color="#2040a0">MigrationStrategyManagerImpl</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>(</strong></font><font color="#2040a0">Migratable</font><font color="4444FF"><strong>)</strong></font> <font color="#2040a0">ProActive</font>.<font color="#2040a0">getBodyOnThis</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
		<font color="#444444">// specify what to do when the active object is about to migrate</font>
		<font color="#444444">// the specified method is then invoked by reflection</font>
		<font color="#2040a0">migrationStrategyManager</font>.<font color="#2040a0">onDeparture</font><font color="4444FF"><strong>(</strong></font><font color="#008000">&quot;clean&quot;</font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
	<font color="4444FF"><strong>}</strong></font>

	<font color="#444444"><i>/** factory for locally creating the active object
	* @param name the name of the agent
	* @return an instance of a ProActive active object of type HelloFrameController
	*
	*/</i></font>
	<strong>public</strong> <strong>static</strong> <font color="#2040a0">HelloFrameController</font> <font color="#2040a0">createHelloFrameController</font><font color="4444FF"><strong>(</strong></font><font color="#2040a0">String</font> <font color="#2040a0">name</font><font color="4444FF"><strong>)</strong></font> <font color="4444FF"><strong>{</strong></font>
		<strong>try</strong> <font color="4444FF"><strong>{</strong></font>
			<font color="#444444">// creates (and initialize) the active object</font>
			<font color="#2040a0">HelloFrameController</font> <font color="#2040a0">obj</font> <font color="4444FF">=</font>
				<font color="4444FF"><strong>(</strong></font><font color="#2040a0">HelloFrameController</font><font color="4444FF"><strong>)</strong></font> <font color="#2040a0">ProActive</font>.<font color="#2040a0">newActive</font><font color="4444FF"><strong>(</strong></font><font color="#2040a0">HelloFrameController</font>.<strong>class</strong>.<font color="#2040a0">getName</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font>, <strong>new</strong> <font color="#2040a0">Object</font><font color="4444FF"><strong>[</strong></font><font color="4444FF"><strong>]</strong></font> <font color="4444FF"><strong>{</strong></font> <font color="#2040a0">name</font> <font color="4444FF"><strong>}</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
			<strong>return</strong> <font color="#2040a0">obj</font><font color="4444FF">;</font>
		<font color="4444FF"><strong>}</strong></font> <strong>catch</strong> <font color="4444FF"><strong>(</strong></font><font color="#2040a0">ActiveObjectCreationException</font> <font color="#2040a0">aoce</font><font color="4444FF"><strong>)</strong></font> <font color="4444FF"><strong>{</strong></font>
			<font color="#2040a0">System</font>.<font color="#2040a0">out</font>.<font color="#2040a0">println</font><font color="4444FF"><strong>(</strong></font><font color="#008000">&quot;creation of the active object failed&quot;</font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
			<font color="#2040a0">aoce</font>.<font color="#2040a0">printStackTrace</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
			<strong>return</strong> <strong>null</strong><font color="4444FF">;</font>
		<font color="4444FF"><strong>}</strong></font> <strong>catch</strong> <font color="4444FF"><strong>(</strong></font><font color="#2040a0">NodeException</font> <font color="#2040a0">ne</font><font color="4444FF"><strong>)</strong></font> <font color="4444FF"><strong>{</strong></font>
			<font color="#2040a0">System</font>.<font color="#2040a0">out</font>.<font color="#2040a0">println</font><font color="4444FF"><strong>(</strong></font><font color="#008000">&quot;creation of default node failed&quot;</font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
			<font color="#2040a0">ne</font>.<font color="#2040a0">printStackTrace</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
			<strong>return</strong> <strong>null</strong><font color="4444FF">;</font>
		<font color="4444FF"><strong>}</strong></font>
	<font color="4444FF"><strong>}</strong></font>

	<strong>public</strong> <font color="#2040a0">String</font> <font color="#2040a0">sayHello</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font> <font color="4444FF"><strong>{</strong></font>
		<strong>if</strong> <font color="4444FF"><strong>(</strong></font><font color="#2040a0">helloFrame</font> <font color="4444FF">=</font><font color="4444FF">=</font> <strong>null</strong><font color="4444FF"><strong>)</strong></font> <font color="4444FF"><strong>{</strong></font>
			<font color="#2040a0">helloFrame</font> <font color="4444FF">=</font> <strong>new</strong> <font color="#2040a0">HelloFrame</font><font color="4444FF"><strong>(</strong></font><font color="#008000">&quot;Hello from &quot;</font> <font color="4444FF">+</font> <font color="#2040a0">ProActive</font>.<font color="#2040a0">getBodyOnThis</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font>.<font color="#2040a0">getNodeURL</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
			<font color="#2040a0">helloFrame</font>.<font color="#2040a0">show</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
		<font color="4444FF"><strong>}</strong></font>
		<strong>return</strong> <font color="#008000">&quot;Hello from &quot;</font> <font color="4444FF">+</font> <font color="#2040a0">ProActive</font>.<font color="#2040a0">getBodyOnThis</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font>.<font color="#2040a0">getNodeURL</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
	<font color="4444FF"><strong>}</strong></font>

	<strong>public</strong> <strong>void</strong> <font color="#2040a0">clean</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font> <font color="4444FF"><strong>{</strong></font>
		<font color="#2040a0">System</font>.<font color="#2040a0">out</font>.<font color="#2040a0">println</font><font color="4444FF"><strong>(</strong></font><font color="#008000">&quot;killing frame&quot;</font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
		<font color="#2040a0">helloFrame</font>.<font color="#2040a0">dispose</font><font color="4444FF"><strong>(</strong></font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
		<font color="#2040a0">helloFrame</font> <font color="4444FF">=</font> <strong>null</strong><font color="4444FF">;</font>
		<font color="#2040a0">System</font>.<font color="#2040a0">out</font>.<font color="#2040a0">println</font><font color="4444FF"><strong>(</strong></font><font color="#008000">&quot;frame is killed&quot;</font><font color="4444FF"><strong>)</strong></font><font color="4444FF">;</font>
	<font color="4444FF"><strong>}</strong></font>
<font color="4444FF"><strong>}</strong></font>

</pre>
<hr>
</body>
</html>
