#!/bin/sh

start_async_kernel () {
   "$JAVACMD" -jar $KERNEL_STARTUP "$@"
}

start_kernel () {
   "$JAVACMD" `"$JAVACMD" -cp $KERNEL_STARTUP edu.emory.mathcs.h2o.server.startup.CreateStartupCmdLine "$@"`
}

cygwin=false;
case "`uname`" in
  CYGWIN*) cygwin=true ;;
esac

H2O_BIN="`dirname \"$0\"`"

KERNEL_STARTUP="${H2O_BIN}/../lib/h2o-server-startup.jar"

if [ -z "$JAVACMD" ] ; then
  if [ -n "$JAVA_HOME"  ] ; then
    JAVACMD="$JAVA_HOME/bin/java"
  else
    JAVACMD=java
  fi
fi

if $cygwin ; then
    KERNEL_STARTUP=`cygpath --path --windows "$KERNEL_STARTUP"`
fi

if [ "$1" = "-daemon" ]
then
   start_async_kernel "$@" || (echo "H2O KERNEL STATUS: NOT STARTED"; echo ""; exit 1)
else
   start_kernel "$@"
fi



